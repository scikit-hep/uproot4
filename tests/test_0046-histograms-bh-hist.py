# BSD 3-Clause License; see https://github.com/scikit-hep/uproot4/blob/master/LICENSE

from __future__ import absolute_import

import numpy
import pytest
import skhep_testdata

import uproot4


def test_numpy_1d():
    with uproot4.open(skhep_testdata.data_path("uproot-hepdata-example.root")) as f:
        values, edges = f["hpx"].np
        assert values.tolist() == [
            2.0,
            2.0,
            3.0,
            1.0,
            1.0,
            2.0,
            4.0,
            6.0,
            12.0,
            8.0,
            9.0,
            15.0,
            15.0,
            31.0,
            35.0,
            40.0,
            64.0,
            64.0,
            81.0,
            108.0,
            124.0,
            156.0,
            165.0,
            209.0,
            262.0,
            297.0,
            392.0,
            432.0,
            466.0,
            521.0,
            604.0,
            657.0,
            788.0,
            903.0,
            1079.0,
            1135.0,
            1160.0,
            1383.0,
            1458.0,
            1612.0,
            1770.0,
            1868.0,
            1861.0,
            1946.0,
            2114.0,
            2175.0,
            2207.0,
            2273.0,
            2276.0,
            2329.0,
            2325.0,
            2381.0,
            2417.0,
            2364.0,
            2284.0,
            2188.0,
            2164.0,
            2130.0,
            1940.0,
            1859.0,
            1763.0,
            1700.0,
            1611.0,
            1459.0,
            1390.0,
            1237.0,
            1083.0,
            1046.0,
            888.0,
            752.0,
            742.0,
            673.0,
            555.0,
            533.0,
            366.0,
            378.0,
            272.0,
            256.0,
            200.0,
            174.0,
            132.0,
            118.0,
            100.0,
            89.0,
            86.0,
            39.0,
            37.0,
            25.0,
            23.0,
            20.0,
            16.0,
            14.0,
            9.0,
            13.0,
            8.0,
            2.0,
            2.0,
            6.0,
            1.0,
            0.0,
            1.0,
            4.0,
        ]

        assert edges.tolist() == [
            -numpy.inf,
            -4.0,
            -3.92,
            -3.84,
            -3.76,
            -3.68,
            -3.6,
            -3.52,
            -3.44,
            -3.36,
            -3.2800000000000002,
            -3.2,
            -3.12,
            -3.04,
            -2.96,
            -2.88,
            -2.8,
            -2.7199999999999998,
            -2.6399999999999997,
            -2.56,
            -2.48,
            -2.4,
            -2.3200000000000003,
            -2.24,
            -2.16,
            -2.08,
            -2.0,
            -1.92,
            -1.8399999999999999,
            -1.7599999999999998,
            -1.6800000000000002,
            -1.6,
            -1.52,
            -1.44,
            -1.3599999999999999,
            -1.2799999999999998,
            -1.1999999999999997,
            -1.12,
            -1.04,
            -0.96,
            -0.8799999999999999,
            -0.7999999999999998,
            -0.7199999999999998,
            -0.6400000000000001,
            -0.56,
            -0.48,
            -0.3999999999999999,
            -0.31999999999999984,
            -0.23999999999999977,
            -0.16000000000000014,
            -0.08000000000000007,
            0.0,
            0.08000000000000007,
            0.16000000000000014,
            0.2400000000000002,
            0.3200000000000003,
            0.40000000000000036,
            0.4800000000000004,
            0.5600000000000005,
            0.6399999999999997,
            0.7199999999999998,
            0.7999999999999998,
            0.8799999999999999,
            0.96,
            1.04,
            1.12,
            1.2000000000000002,
            1.2800000000000002,
            1.3600000000000003,
            1.4400000000000004,
            1.5200000000000005,
            1.6000000000000005,
            1.6799999999999997,
            1.7599999999999998,
            1.8399999999999999,
            1.92,
            2.0,
            2.08,
            2.16,
            2.24,
            2.3200000000000003,
            2.4000000000000004,
            2.4800000000000004,
            2.5600000000000005,
            2.6400000000000006,
            2.7199999999999998,
            2.8,
            2.88,
            2.96,
            3.04,
            3.12,
            3.2,
            3.2800000000000002,
            3.3600000000000003,
            3.4400000000000004,
            3.5200000000000005,
            3.6000000000000005,
            3.6799999999999997,
            3.76,
            3.84,
            3.92,
            4.0,
            numpy.inf,
        ]


def test_numpy_2d():
    with uproot4.open(skhep_testdata.data_path("uproot-hepdata-example.root")) as f:
        values, xedges, yedges = f["hpxpy"].np

        assert values.tolist() == [
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                2.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                2.0,
                1.0,
                2.0,
                2.0,
                0.0,
                1.0,
                0.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                3.0,
                1.0,
                0.0,
                1.0,
                2.0,
                1.0,
                0.0,
                1.0,
                1.0,
                1.0,
                2.0,
                1.0,
                2.0,
                3.0,
                0.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                2.0,
                0.0,
                2.0,
                4.0,
                2.0,
                5.0,
                2.0,
                2.0,
                1.0,
                5.0,
                3.0,
                4.0,
                4.0,
                1.0,
                4.0,
                1.0,
                2.0,
                1.0,
                2.0,
                1.0,
                0.0,
                0.0,
                1.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                3.0,
                1.0,
                6.0,
                1.0,
                3.0,
                6.0,
                3.0,
                6.0,
                9.0,
                6.0,
                9.0,
                5.0,
                2.0,
                4.0,
                4.0,
                1.0,
                6.0,
                1.0,
                2.0,
                0.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                2.0,
                0.0,
                0.0,
                3.0,
                4.0,
                5.0,
                5.0,
                6.0,
                9.0,
                17.0,
                8.0,
                13.0,
                13.0,
                14.0,
                11.0,
                13.0,
                6.0,
                10.0,
                5.0,
                4.0,
                5.0,
                7.0,
                2.0,
                1.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                4.0,
                4.0,
                5.0,
                11.0,
                7.0,
                8.0,
                13.0,
                17.0,
                16.0,
                28.0,
                16.0,
                22.0,
                24.0,
                22.0,
                18.0,
                17.0,
                10.0,
                6.0,
                4.0,
                8.0,
                6.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                5.0,
                1.0,
                6.0,
                9.0,
                9.0,
                22.0,
                16.0,
                20.0,
                29.0,
                33.0,
                21.0,
                35.0,
                34.0,
                19.0,
                32.0,
                30.0,
                28.0,
                17.0,
                14.0,
                8.0,
                11.0,
                4.0,
                2.0,
                2.0,
                2.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                3.0,
                2.0,
                4.0,
                6.0,
                11.0,
                10.0,
                18.0,
                20.0,
                34.0,
                39.0,
                42.0,
                51.0,
                47.0,
                68.0,
                60.0,
                41.0,
                47.0,
                37.0,
                43.0,
                27.0,
                22.0,
                15.0,
                16.0,
                11.0,
                4.0,
                1.0,
                0.0,
                3.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                3.0,
                2.0,
                7.0,
                6.0,
                8.0,
                21.0,
                23.0,
                44.0,
                53.0,
                60.0,
                73.0,
                95.0,
                82.0,
                68.0,
                86.0,
                88.0,
                72.0,
                66.0,
                52.0,
                40.0,
                28.0,
                27.0,
                15.0,
                17.0,
                8.0,
                6.0,
                4.0,
                2.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                0.0,
                0.0,
                1.0,
                2.0,
                1.0,
                2.0,
                7.0,
                5.0,
                14.0,
                20.0,
                28.0,
                32.0,
                57.0,
                58.0,
                74.0,
                93.0,
                93.0,
                106.0,
                95.0,
                129.0,
                126.0,
                103.0,
                98.0,
                75.0,
                86.0,
                57.0,
                33.0,
                35.0,
                22.0,
                19.0,
                8.0,
                5.0,
                3.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                4.0,
                9.0,
                7.0,
                12.0,
                14.0,
                36.0,
                31.0,
                54.0,
                60.0,
                88.0,
                94.0,
                104.0,
                134.0,
                150.0,
                142.0,
                179.0,
                120.0,
                135.0,
                119.0,
                108.0,
                91.0,
                56.0,
                38.0,
                43.0,
                20.0,
                15.0,
                12.0,
                5.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                2.0,
                1.0,
                4.0,
                11.0,
                5.0,
                21.0,
                47.0,
                39.0,
                69.0,
                100.0,
                106.0,
                145.0,
                169.0,
                164.0,
                199.0,
                190.0,
                210.0,
                197.0,
                209.0,
                141.0,
                162.0,
                123.0,
                87.0,
                64.0,
                39.0,
                34.0,
                16.0,
                15.0,
                9.0,
                4.0,
                3.0,
                4.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
            ],
            [
                1.0,
                0.0,
                0.0,
                0.0,
                2.0,
                1.0,
                4.0,
                8.0,
                12.0,
                16.0,
                26.0,
                40.0,
                48.0,
                81.0,
                149.0,
                131.0,
                171.0,
                222.0,
                231.0,
                241.0,
                260.0,
                270.0,
                260.0,
                200.0,
                203.0,
                155.0,
                150.0,
                111.0,
                67.0,
                61.0,
                27.0,
                26.0,
                28.0,
                12.0,
                4.0,
                5.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                2.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                3.0,
                5.0,
                7.0,
                13.0,
                23.0,
                46.0,
                49.0,
                88.0,
                106.0,
                148.0,
                179.0,
                211.0,
                232.0,
                298.0,
                284.0,
                287.0,
                275.0,
                281.0,
                284.0,
                233.0,
                211.0,
                172.0,
                142.0,
                84.0,
                86.0,
                46.0,
                26.0,
                24.0,
                13.0,
                10.0,
                3.0,
                3.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                1.0,
                0.0,
                2.0,
                4.0,
                2.0,
                8.0,
                16.0,
                28.0,
                42.0,
                61.0,
                87.0,
                105.0,
                155.0,
                215.0,
                253.0,
                250.0,
                353.0,
                334.0,
                363.0,
                370.0,
                344.0,
                341.0,
                303.0,
                268.0,
                197.0,
                169.0,
                119.0,
                99.0,
                80.0,
                49.0,
                25.0,
                22.0,
                11.0,
                1.0,
                2.0,
                1.0,
                2.0,
                1.0,
                0.0,
                0.0,
            ],
            [
                1.0,
                0.0,
                0.0,
                0.0,
                2.0,
                3.0,
                7.0,
                10.0,
                25.0,
                28.0,
                47.0,
                61.0,
                80.0,
                126.0,
                201.0,
                206.0,
                281.0,
                361.0,
                341.0,
                403.0,
                403.0,
                416.0,
                398.0,
                360.0,
                345.0,
                278.0,
                247.0,
                206.0,
                131.0,
                83.0,
                69.0,
                54.0,
                30.0,
                22.0,
                13.0,
                5.0,
                3.0,
                2.0,
                3.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                0.0,
                1.0,
                0.0,
                4.0,
                7.0,
                17.0,
                16.0,
                25.0,
                52.0,
                70.0,
                102.0,
                132.0,
                198.0,
                274.0,
                321.0,
                346.0,
                420.0,
                479.0,
                448.0,
                445.0,
                411.0,
                391.0,
                348.0,
                339.0,
                237.0,
                202.0,
                153.0,
                131.0,
                71.0,
                51.0,
                39.0,
                19.0,
                16.0,
                11.0,
                4.0,
                4.0,
                1.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                1.0,
                0.0,
                1.0,
                4.0,
                9.0,
                10.0,
                18.0,
                37.0,
                44.0,
                87.0,
                92.0,
                140.0,
                198.0,
                236.0,
                311.0,
                375.0,
                432.0,
                445.0,
                478.0,
                497.0,
                476.0,
                412.0,
                360.0,
                331.0,
                255.0,
                211.0,
                165.0,
                131.0,
                76.0,
                45.0,
                34.0,
                23.0,
                12.0,
                2.0,
                4.0,
                2.0,
                0.0,
                2.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                1.0,
                2.0,
                1.0,
                3.0,
                13.0,
                13.0,
                21.0,
                41.0,
                51.0,
                95.0,
                108.0,
                148.0,
                216.0,
                261.0,
                354.0,
                363.0,
                425.0,
                438.0,
                446.0,
                449.0,
                436.0,
                424.0,
                367.0,
                339.0,
                279.0,
                209.0,
                151.0,
                107.0,
                79.0,
                46.0,
                28.0,
                21.0,
                9.0,
                5.0,
                8.0,
                1.0,
                2.0,
                3.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                4.0,
                2.0,
                3.0,
                10.0,
                17.0,
                22.0,
                41.0,
                53.0,
                90.0,
                100.0,
                137.0,
                207.0,
                243.0,
                317.0,
                349.0,
                404.0,
                408.0,
                439.0,
                440.0,
                488.0,
                443.0,
                350.0,
                305.0,
                271.0,
                181.0,
                151.0,
                101.0,
                66.0,
                55.0,
                27.0,
                20.0,
                18.0,
                3.0,
                3.0,
                2.0,
                3.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                1.0,
                2.0,
                6.0,
                4.0,
                17.0,
                20.0,
                27.0,
                41.0,
                74.0,
                97.0,
                130.0,
                182.0,
                240.0,
                289.0,
                333.0,
                360.0,
                386.0,
                401.0,
                426.0,
                393.0,
                370.0,
                302.0,
                239.0,
                218.0,
                174.0,
                129.0,
                112.0,
                82.0,
                39.0,
                27.0,
                20.0,
                19.0,
                8.0,
                6.0,
                4.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                3.0,
                9.0,
                19.0,
                24.0,
                56.0,
                62.0,
                100.0,
                121.0,
                159.0,
                207.0,
                269.0,
                312.0,
                326.0,
                316.0,
                396.0,
                385.0,
                331.0,
                323.0,
                280.0,
                241.0,
                189.0,
                158.0,
                126.0,
                86.0,
                67.0,
                33.0,
                22.0,
                10.0,
                6.0,
                4.0,
                2.0,
                1.0,
                1.0,
                0.0,
                1.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                0.0,
                2.0,
                1.0,
                0.0,
                3.0,
                12.0,
                9.0,
                21.0,
                30.0,
                66.0,
                71.0,
                104.0,
                153.0,
                162.0,
                221.0,
                247.0,
                301.0,
                300.0,
                314.0,
                278.0,
                302.0,
                262.0,
                251.0,
                223.0,
                194.0,
                157.0,
                125.0,
                76.0,
                58.0,
                40.0,
                18.0,
                20.0,
                8.0,
                3.0,
                2.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                1.0,
                5.0,
                1.0,
                4.0,
                1.0,
                9.0,
                19.0,
                24.0,
                50.0,
                76.0,
                88.0,
                102.0,
                138.0,
                199.0,
                195.0,
                211.0,
                218.0,
                245.0,
                273.0,
                236.0,
                221.0,
                203.0,
                161.0,
                152.0,
                105.0,
                92.0,
                69.0,
                49.0,
                24.0,
                10.0,
                11.0,
                5.0,
                6.0,
                4.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                0.0,
                1.0,
                2.0,
                1.0,
                6.0,
                6.0,
                16.0,
                16.0,
                19.0,
                42.0,
                35.0,
                68.0,
                104.0,
                115.0,
                139.0,
                176.0,
                175.0,
                231.0,
                226.0,
                210.0,
                205.0,
                180.0,
                155.0,
                136.0,
                108.0,
                89.0,
                70.0,
                57.0,
                32.0,
                22.0,
                11.0,
                8.0,
                5.0,
                4.0,
                1.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                3.0,
                7.0,
                7.0,
                15.0,
                20.0,
                24.0,
                32.0,
                53.0,
                66.0,
                85.0,
                97.0,
                109.0,
                139.0,
                135.0,
                134.0,
                141.0,
                171.0,
                159.0,
                121.0,
                93.0,
                92.0,
                62.0,
                46.0,
                39.0,
                21.0,
                20.0,
                6.0,
                5.0,
                1.0,
                1.0,
                1.0,
                2.0,
                1.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                1.0,
                0.0,
                1.0,
                1.0,
                0.0,
                1.0,
                2.0,
                3.0,
                11.0,
                21.0,
                14.0,
                26.0,
                35.0,
                44.0,
                65.0,
                73.0,
                92.0,
                93.0,
                111.0,
                114.0,
                115.0,
                115.0,
                91.0,
                64.0,
                86.0,
                52.0,
                44.0,
                33.0,
                32.0,
                22.0,
                15.0,
                4.0,
                5.0,
                4.0,
                2.0,
                2.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                1.0,
                4.0,
                4.0,
                12.0,
                16.0,
                31.0,
                30.0,
                28.0,
                59.0,
                50.0,
                51.0,
                62.0,
                77.0,
                66.0,
                77.0,
                61.0,
                75.0,
                49.0,
                63.0,
                41.0,
                34.0,
                23.0,
                17.0,
                21.0,
                8.0,
                9.0,
                4.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                6.0,
                4.0,
                8.0,
                7.0,
                12.0,
                16.0,
                21.0,
                27.0,
                31.0,
                43.0,
                56.0,
                68.0,
                44.0,
                50.0,
                65.0,
                38.0,
                43.0,
                32.0,
                32.0,
                20.0,
                22.0,
                11.0,
                9.0,
                11.0,
                1.0,
                0.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                3.0,
                2.0,
                2.0,
                2.0,
                1.0,
                7.0,
                9.0,
                9.0,
                8.0,
                22.0,
                29.0,
                26.0,
                26.0,
                27.0,
                29.0,
                32.0,
                23.0,
                28.0,
                28.0,
                25.0,
                16.0,
                15.0,
                10.0,
                8.0,
                5.0,
                4.0,
                2.0,
                2.0,
                1.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                2.0,
                2.0,
                4.0,
                6.0,
                11.0,
                13.0,
                9.0,
                17.0,
                11.0,
                27.0,
                23.0,
                25.0,
                19.0,
                24.0,
                21.0,
                15.0,
                22.0,
                12.0,
                7.0,
                1.0,
                4.0,
                2.0,
                2.0,
                2.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                3.0,
                0.0,
                4.0,
                3.0,
                4.0,
                7.0,
                11.0,
                7.0,
                11.0,
                12.0,
                14.0,
                15.0,
                11.0,
                10.0,
                8.0,
                10.0,
                5.0,
                9.0,
                2.0,
                3.0,
                5.0,
                0.0,
                1.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                2.0,
                8.0,
                4.0,
                5.0,
                4.0,
                6.0,
                11.0,
                3.0,
                8.0,
                8.0,
                4.0,
                6.0,
                4.0,
                0.0,
                1.0,
                7.0,
                1.0,
                3.0,
                2.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                2.0,
                1.0,
                0.0,
                3.0,
                2.0,
                1.0,
                6.0,
                12.0,
                5.0,
                5.0,
                1.0,
                2.0,
                2.0,
                4.0,
                1.0,
                1.0,
                0.0,
                3.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                2.0,
                2.0,
                0.0,
                0.0,
                6.0,
                3.0,
                2.0,
                2.0,
                1.0,
                1.0,
                1.0,
                1.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                2.0,
                2.0,
                1.0,
                3.0,
                3.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                3.0,
                1.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                1.0,
                0.0,
                0.0,
                2.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
        ]

        assert xedges.tolist() == [
            -numpy.inf,
            -4.0,
            -3.8,
            -3.6,
            -3.4,
            -3.2,
            -3.0,
            -2.8,
            -2.5999999999999996,
            -2.4,
            -2.2,
            -2.0,
            -1.7999999999999998,
            -1.5999999999999996,
            -1.4,
            -1.1999999999999997,
            -1.0,
            -0.7999999999999998,
            -0.5999999999999996,
            -0.3999999999999999,
            -0.19999999999999973,
            0.0,
            0.20000000000000018,
            0.40000000000000036,
            0.6000000000000005,
            0.8000000000000007,
            1.0,
            1.2000000000000002,
            1.4000000000000004,
            1.6000000000000005,
            1.8000000000000007,
            2.0,
            2.2,
            2.4000000000000004,
            2.6000000000000005,
            2.8000000000000007,
            3.0,
            3.2,
            3.4000000000000004,
            3.6000000000000005,
            3.8000000000000007,
            4.0,
            numpy.inf,
        ]

        assert yedges.tolist() == [
            -numpy.inf,
            -4.0,
            -3.8,
            -3.6,
            -3.4,
            -3.2,
            -3.0,
            -2.8,
            -2.5999999999999996,
            -2.4,
            -2.2,
            -2.0,
            -1.7999999999999998,
            -1.5999999999999996,
            -1.4,
            -1.1999999999999997,
            -1.0,
            -0.7999999999999998,
            -0.5999999999999996,
            -0.3999999999999999,
            -0.19999999999999973,
            0.0,
            0.20000000000000018,
            0.40000000000000036,
            0.6000000000000005,
            0.8000000000000007,
            1.0,
            1.2000000000000002,
            1.4000000000000004,
            1.6000000000000005,
            1.8000000000000007,
            2.0,
            2.2,
            2.4000000000000004,
            2.6000000000000005,
            2.8000000000000007,
            3.0,
            3.2,
            3.4000000000000004,
            3.6000000000000005,
            3.8000000000000007,
            4.0,
            numpy.inf,
        ]
